{# calculator.twig #}
{% set attributeCollection = attributes|default({})|collect() %}
{% set additionalClasses = attributeCollection.get('class') %}
{% set additionalAttributes = attributeCollection.forget(['class']).toArray() %}

{% set discountPct = discountPct|default(0) %}
{% set labels = labels|default({
    range: 'Nutzer',
    ftp: 'Jährliches Online-Abonnement',
    ftpOption: 'Preisreferenzexport (FTP-Zugang), für VLB-Abonnenten kostenlos',
    total: 'Preis pro Jahr in €',
    totalDiscount: 'Preis pro Jahr in €'
}) %}

<div
        {{ attributesToHtml(additionalAttributes) }}
        data-component="molecules.vlb-subscription-calculator"
        data-discount-pct="{{ discountPct }}"
        class="mb-6"
        {{ additionalClasses }}
>
    {% if legend is defined and legend %}
        <div class="block text-base mb-1 font-semibold">{{ legend }}</div>
    {% endif %}


    {# Haupt-Container: weiße Box mit Umrandung, links Inputs in einer Reihe, rechts Preise #}
    <div class="sm:flex gap-4 items-start justify-between bg-white border border-cobblestone-600 px-4 py-3">

        {# Linke Seite: Inputs in einer Zeile #}
        <div class="flex items-start gap-6 lg:w-2/3">

            {# Range-Auswahl #}
            <div class="block min-w-32">
                <label class="block mb-2 font-bold" for="vlb-range">{{ labels.range }}</label>
                <div class="mt-1 grid grid-cols-1">


                <select
                        name="range"
                        id="vlb-range"
                        data-component-part="vlb-subscription-calculator.range"
                        class="w-full text-base bg-white py-2 outline outline-1 -outline-offset-1 outline-cobblestone-600 focus:outline-2 focus:-outline-offset-2 focus:outline-persian-blue-400 col-start-1 row-start-1 appearance-none pr-8 pl-3"
                >
                    {% for opt in options %}
                        <option
                                value="{{ opt.value }}"
                                data-price="{{ opt.price }}"
                                {% if opt.selected is defined and opt.selected %}selected{% endif %}
                        >
                            {{ opt.label }}
                        </option>
                    {% endfor %}
                </select>
                    <svg class="pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-gray-500 sm:size-4" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true" data-slot="icon">
                        <path fill-rule="evenodd" d="M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"></path>
                    </svg>
                </div>
            </div>

            {# FTP Checkbox (optional) #}

            <fieldset class="">
                <legend class="block font-bold mb-2" for="ftp">{{ labels.ftp }}</legend>

                <div class="flex gap-2">
                    <div class="flex h-6 shrink-0 items-center">
                        <div class="group grid size-4 grid-cols-1">
                            <input type="checkbox"
                                   name="ftp"
                                   id="vlb-ftp"
                                   data-fee-checked="{{ ftpFeeChecked|default('0.0') }}"
                                   data-fee-unchecked="{{ ftpFeeUnchecked|default('0.0') }}"
                                   data-component-part="vlb-subscription-calculator.ftp"
                                   class="bg-white focus:outline-persian-blue-400 appearance-none size-4 border border-cobblestone-600 checked:border-persian-blue-600 checked:bg-persian-blue-600 focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-persian-blue-400 col-start-1 row-start-1 rounded-sm indeterminate:border-primary-600 indeterminate:bg-primary-600"
                                   {% if ftpChecked is defined and ftpChecked %}checked{% endif %}>
                            <svg class="pointer-events-none col-start-1 row-start-1 size-3.5 self-center justify-self-center stroke-white group-has-disabled:stroke-gray-950/25" viewBox="0 0 14 14" fill="none">
                                <path class="opacity-0 group-has-checked:opacity-100" d="M3 8L6 11L11 3.5" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                                <path class="opacity-0 group-has-indeterminate:opacity-100" d="M3 7H11" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="text-sm/6">
                        <label for="vlb-ftp" class="block text-base max-w-sm">
                            {{ labels.ftpOption }}
                        </label>
                    </div>
                </div>
            </fieldset>

        </div>

        {# Rechte Seite: Preise, rechtsbündig und größer #}
        <div class="border-t border-cobblestone-200 pt-2 mt-4 sm:pt-0 sm:mt-0 sm:border-0 text-left min-w-[160px] lg:w-1/3">
            <div class="leading-tight">
                <div class="flex items-end justify-between sm:block">
                   <div class="font-bold sm:mb-2">{{ labels.total }}</div>
                    <span data-component-part="vlb-subscription-calculator.total-new" class="font-bold text-xl md:text-2xl ml-auto mr-1">0,00</span><span class="text-sm md:text-base mb-0.5 sm:mb-0"> (zzgl. MwSt.)</span>
                </div>

                {% if discountPct > 0 %}
                    <div data-component-part="vlb-subscription-calculator.discount-row" class="text-base md:text-lg font-semibold opacity-90">
                        <span class="sr-only">{{ labels.totalDiscount }}</span>
                        <span data-component-part="vlb-subscription-calculator.total-discount">0,00</span>
                    </div>
                {% endif %}
            </div>
        </div>

        <input type="hidden" data-component-part="vlb-subscription-calculator.hidden-total" />
    </div>

    {% if description is defined and description %}
        <div class="block text-base mt-2 font-normal">{{ description }}</div>
    {% endif %}
</div>