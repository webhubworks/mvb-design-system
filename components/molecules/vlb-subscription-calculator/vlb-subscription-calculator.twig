{# calculator.twig #}
{% set attributeCollection = attributes|default({})|collect() %}
{% set additionalClasses = attributeCollection.get('class') %}
{% set additionalAttributes = attributeCollection.forget(['class']).toArray() %}

{% set discountPct = discountPct|default(0) %}
{% set labels = labels|default({
    range: 'Nutzer',
    total: 'Preis pro Jahr in €',
    totalDiscount: 'Preis pro Jahr mit Rabatt in €'
}) %}

<div
        {{ attributesToHtml(additionalAttributes) }}
        data-component="molecules.vlb-subscription-calculator"
        data-discount-pct="{{ discountPct }}"
        class="mb-6"
        {{ additionalClasses }}
>
    {% if legend is defined and legend %}
        <div class="block text-base mb-1 font-semibold">{{ legend }}</div>
    {% endif %}

    {% if discountText is defined and discountText %}
    <div class="text-white bg-primary px-4 py-4 block rich-text [&_:is(h1,h2,h3)]:!mt-0">
        {{ discountText|raw }}
    </div>
    {% endif %}

    {# Haupt-Container: weiße Box mit Umrandung, links Inputs in einer Reihe, rechts Preise #}
    <div class="sm:flex gap-4 items-start justify-between bg-white border border-cobblestone-600 {{ discountPct is defined and discountPct ? 'border-primary' : 'border-cobblestone-600'}} px-4 py-3">

        {# Linke Seite: Range-Auswahl #}
        <div class="flex items-start gap-6 lg:w-2/3">

            {# Range-Auswahl #}
            <div class="block min-w-32">
                <label class="block mb-2 font-bold" for="vlb-range">{{ labels.range }}</label>
                <div class="mt-1 grid grid-cols-1">

                <select
                        name="range"
                        id="vlb-range"
                        data-component-part="vlb-subscription-calculator.range"
                        class="w-full text-base bg-white py-2 outline outline-1 -outline-offset-1 outline-cobblestone-600 focus:outline-2 focus:-outline-offset-2 focus:outline-persian-blue-400 col-start-1 row-start-1 appearance-none pr-8 pl-3"
                >
                    {% for opt in options %}
                        <option
                                value="{{ opt.value }}"
                                data-price="{{ opt.price }}"
                                {% if opt.selected is defined and opt.selected %}selected{% endif %}
                        >
                            {{ opt.label }}
                        </option>
                    {% endfor %}
                </select>
                    <svg class="pointer-events-none col-start-1 row-start-1 mr-2 size-5 self-center justify-self-end text-gray-500 sm:size-4" viewBox="0 0 16 16" fill="currentColor" aria-hidden="true" data-slot="icon">
                        <path fill-rule="evenodd" d="M4.22 6.22a.75.75 0 0 1 1.06 0L8 8.94l2.72-2.72a.75.75 0 1 1 1.06 1.06l-3.25 3.25a.75.75 0 0 1-1.06 0L4.22 7.28a.75.75 0 0 1 0-1.06Z" clip-rule="evenodd"></path>
                    </svg>
                </div>
            </div>

        </div>

        {# Rechte Seite: Preise, rechtsbündig und größer #}
        <div class="border-t border-cobblestone-200 pt-2 mt-4 sm:pt-0 sm:mt-0 sm:border-0 text-left min-w-[160px] lg:w-1/3 lg:h-full">
            <div class="leading-tight">
                <div class="xs:flex items-end justify-between sm:block">
                   <div class="font-bold sm:mb-2">{{ labels.total }}</div>
                    {% if discountPct > 0 %}
                        <div>
                            <span data-component-part="vlb-subscription-calculator.total-new" class="font-bold text-xl md:text-2xl lg:text-3xl ml-auto mr-1 line-through opacity-60">0,00</span>
                            <span data-component-part="vlb-subscription-calculator.total-discount" class="font-bold text-xl md:text-2xl lg:text-3xl ml-auto mr-1 text-primary">0,00</span>
                            <span class="text-sm md:text-base mb-0.5 sm:mb-0"> (zzgl. MwSt.)</span>
                        </div>
                    {% else %}
                        <div>
                            <span data-component-part="vlb-subscription-calculator.total-new" class="font-bold text-xl md:text-2xl lg:text-3xl ml-auto mr-1">0,00</span>
                            <span class="text-sm md:text-base mb-0.5 sm:mb-0"> (zzgl. MwSt.)</span>
                        </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <input type="hidden" data-component-part="vlb-subscription-calculator.hidden-total" />
    </div>

    {% if description is defined and description %}
        <div class="block text-base mt-2 font-normal">{{ description }}</div>
    {% endif %}
</div>